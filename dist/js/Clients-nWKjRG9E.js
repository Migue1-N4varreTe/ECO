var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(s,a,l)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[a]=l,n=(e,s)=>{for(var a in s||(s={}))t.call(s,a)&&r(e,a,s[a]);if(l)for(var a of l(s))i.call(s,a)&&r(e,a,s[a]);return e},c=(e,l)=>s(e,a(l)),d=(e,s,a)=>new Promise((l,t)=>{var i=e=>{try{n(a.next(e))}catch(s){t(s)}},r=e=>{try{n(a.throw(e))}catch(s){t(s)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(i,r);n((a=a.apply(e,s)).next())});import{j as o,X as x,bw as m,as as h,bB as j,bC as u,bi as p,bx as g,bA as v,aC as N,bD as y,aE as f,a8 as b,bE as w,bu as C,a7 as P,av as S,at as D,a$ as T,aa as k,aZ as A,aH as E,aL as F,bF as M,aK as L,aW as z,aA as V,ap as I}from"./chunk-D1ivKm1I.js";import{R as B,a as R}from"./chunk-CNNdbZTC.js";import{C as O,e as G,L as U,I as $,b as K,B as q,p as H,n as J,o as W,D as X,q as Y,r as Z,t as _,v as Q,E as ee,F as se,G as ae,H as le,N as te}from"./index-17eEFbcJ.js";import{S as ie,a as re,b as ne,c as ce,d as de}from"./chunk-DQJYHBrk.js";import{T as oe,a as xe,b as me,c as he}from"./chunk-BDIyvL0l.js";import{T as je,a as ue,b as pe,c as ge,d as ve,e as Ne}from"./chunk-D6McqOhn.js";import{u as ye,t as fe}from"./chunk-BYIEES8I.js";import{T as be}from"./chunk-DtJU0gqK.js";import{o as we,K as Ce,L as Pe,s as Se}from"./chunk-BdChqvju.js";import{R as De,A as Te,C as ke,X as Ae,Y as Ee,T as Fe,c as Me,P as Le,d as ze,e as Ve,B as Ie,b as Be}from"./chunk-DfqLu1IB.js";import"./chunk-DGERTDnL.js";import"./chunk-B5XYL1Sr.js";const Re=we({name:Se().min(2,"El nombre debe tener al menos 2 caracteres"),email:Se().email("Email inválido"),phone:Se().min(10,"El teléfono debe tener al menos 10 dígitos"),address:Se().min(5,"La dirección debe tener al menos 5 caracteres"),birthday:Se().optional(),tier:Pe(["bronze","silver","gold","platinum"]),status:Pe(["active","inactive","vip"]),preferences:Ce(Se()).optional()}),Oe=({initialData:e,onSubmit:s,onCancel:a})=>{const[l,t]=B.useState((null==e?void 0:e.preferences)||[]),{register:i,handleSubmit:r,setValue:d,watch:m,formState:{errors:h,isSubmitting:j}}=ye({resolver:fe(Re),defaultValues:{name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||"",phone:(null==e?void 0:e.phone)||"",address:(null==e?void 0:e.address)||"",birthday:(null==e?void 0:e.birthday)||"",tier:(null==e?void 0:e.tier)||"bronze",status:(null==e?void 0:e.status)||"active",preferences:l}});return o.jsxs("form",{onSubmit:r(e=>{s(c(n({},e),{preferences:l}))}),className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsx(O,{children:o.jsxs(G,{className:"p-6",children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Información Personal"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(U,{htmlFor:"name",children:"Nombre Completo"}),o.jsx($,c(n({id:"name"},i("name")),{placeholder:"Nombre completo del cliente"})),h.name&&o.jsx("p",{className:"text-sm text-red-600 mt-1",children:h.name.message})]}),o.jsxs("div",{children:[o.jsx(U,{htmlFor:"email",children:"Email"}),o.jsx($,c(n({id:"email",type:"email"},i("email")),{placeholder:"cliente@email.com"})),h.email&&o.jsx("p",{className:"text-sm text-red-600 mt-1",children:h.email.message})]}),o.jsxs("div",{children:[o.jsx(U,{htmlFor:"phone",children:"Teléfono"}),o.jsx($,c(n({id:"phone"},i("phone")),{placeholder:"+584241234567"})),h.phone&&o.jsx("p",{className:"text-sm text-red-600 mt-1",children:h.phone.message})]}),o.jsxs("div",{children:[o.jsx(U,{htmlFor:"birthday",children:"Fecha de Nacimiento"}),o.jsx($,n({id:"birthday",type:"date"},i("birthday")))]})]})]})}),o.jsx(O,{children:o.jsxs(G,{className:"p-6",children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Contacto y Estado"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(U,{htmlFor:"address",children:"Dirección"}),o.jsx(be,c(n({id:"address"},i("address")),{placeholder:"Dirección completa del cliente",rows:3})),h.address&&o.jsx("p",{className:"text-sm text-red-600 mt-1",children:h.address.message})]}),o.jsxs("div",{children:[o.jsx(U,{htmlFor:"status",children:"Estado"}),o.jsxs(ie,{value:m("status"),onValueChange:e=>d("status",e),children:[o.jsx(re,{children:o.jsx(ne,{placeholder:"Seleccionar estado"})}),o.jsxs(ce,{children:[o.jsx(de,{value:"active",children:"Activo"}),o.jsx(de,{value:"inactive",children:"Inactivo"}),o.jsx(de,{value:"vip",children:"VIP"})]})]})]}),o.jsxs("div",{children:[o.jsx(U,{htmlFor:"tier",children:"Nivel de Fidelidad"}),o.jsxs(ie,{value:m("tier"),onValueChange:e=>d("tier",e),children:[o.jsx(re,{children:o.jsx(ne,{placeholder:"Seleccionar nivel"})}),o.jsxs(ce,{children:[o.jsx(de,{value:"bronze",children:"Bronce"}),o.jsx(de,{value:"silver",children:"Plata"}),o.jsx(de,{value:"gold",children:"Oro"}),o.jsx(de,{value:"platinum",children:"Platino"})]})]})]})]})]})})]}),o.jsx(O,{children:o.jsxs(G,{className:"p-6",children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preferencias de Compra"}),o.jsxs("div",{className:"mb-4",children:[o.jsx(U,{children:"Categorías Preferidas"}),o.jsxs(ie,{onValueChange:e=>{if(!l.includes(e)){const s=[...l,e];t(s),d("preferences",s)}},children:[o.jsx(re,{children:o.jsx(ne,{placeholder:"Agregar preferencia"})}),o.jsx(ce,{children:["lácteos","panadería","frutas","verduras","carnes","bebidas","limpieza","cuidado personal","productos orgánicos","vinos","gourmet","congelados"].filter(e=>!l.includes(e)).map(e=>o.jsx(de,{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(e=>o.jsxs(K,{variant:"secondary",className:"flex items-center gap-1",children:[e.charAt(0).toUpperCase()+e.slice(1),o.jsx("button",{type:"button",onClick:()=>(e=>{const s=l.filter(s=>s!==e);t(s),d("preferences",s)})(e),className:"ml-1 hover:bg-red-100 rounded-full p-0.5",children:o.jsx(x,{className:"h-3 w-3"})})]},e))})]})}),o.jsxs("div",{className:"flex justify-end space-x-4",children:[o.jsx(q,{type:"button",variant:"outline",onClick:a,children:"Cancelar"}),o.jsx(q,{type:"submit",disabled:j,children:j?"Guardando...":e?"Actualizar":"Crear Cliente"})]})]})},Ge=({clients:e,onUpdateClient:s})=>{const[a,l]=R.useState(null),[t,i]=R.useState(""),[r,d]=R.useState(""),[x,C]=R.useState(""),{toast:P}=H(),S=[{name:"Bronce",minPoints:0,color:"bg-orange-100 text-orange-800",benefits:["Puntos básicos por compra","Ofertas mensuales"],discount:2,icon:m},{name:"Plata",minPoints:500,color:"bg-gray-100 text-gray-800",benefits:["5% de descuento","Acceso a ventas exclusivas","Puntos dobles en fechas especiales"],discount:5,icon:h},{name:"Oro",minPoints:1500,color:"bg-yellow-100 text-yellow-800",benefits:["8% de descuento","Envío gratis","Atención prioritaria","Regalos de cumpleaños"],discount:8,icon:j},{name:"Platino",minPoints:3e3,color:"bg-purple-100 text-purple-800",benefits:["12% de descuento","Concierge personal","Eventos exclusivos","Early access"],discount:12,icon:u}],[D]=R.useState([{id:"1",clientId:"1",clientName:"María González",type:"earned",points:25,description:"Compra - Ticket #12345",date:"2024-11-28"},{id:"2",clientId:"1",clientName:"María González",type:"redeemed",points:-100,description:"Canje - Descuento 10%",date:"2024-11-25"},{id:"3",clientId:"2",clientName:"Carlos Rodríguez",type:"earned",points:15,description:"Compra - Ticket #12344",date:"2024-11-25"}]),T=e=>S.slice().reverse().find(s=>e>=s.minPoints)||S[0],k={totalMembers:e.length,activeMembers:e.filter(e=>"active"===e.status).length,totalPointsAwarded:e.reduce((e,s)=>e+s.loyaltyPoints,0),averagePoints:Math.round(e.reduce((e,s)=>e+s.loyaltyPoints,0)/e.length||0)},A=S.map(s=>c(n({},s),{count:e.filter(e=>T(e.loyaltyPoints).name===s.name).length}));return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(p,{className:"h-8 w-8 text-blue-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Miembros Totales"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.totalMembers})]})]})})}),o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(g,{className:"h-8 w-8 text-green-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Miembros Activos"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.activeMembers})]})]})})}),o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(m,{className:"h-8 w-8 text-yellow-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Puntos Totales"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.totalPointsAwarded.toLocaleString()})]})]})})}),o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(v,{className:"h-8 w-8 text-purple-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Promedio Puntos"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.averagePoints})]})]})})})]}),o.jsxs(oe,{defaultValue:"tiers",className:"space-y-6",children:[o.jsxs(xe,{className:"grid w-full grid-cols-4",children:[o.jsx(me,{value:"tiers",children:"Niveles de Fidelidad"}),o.jsx(me,{value:"rewards",children:"Recompensas"}),o.jsx(me,{value:"management",children:"Gestión"}),o.jsx(me,{value:"history",children:"Historial"})]}),o.jsxs(he,{value:"tiers",className:"space-y-6",children:[o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:A.map(e=>{const s=e.icon;return o.jsx(O,{className:"relative overflow-hidden",children:o.jsxs(G,{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx(K,{className:e.color,children:e.name}),o.jsx(s,{className:"h-6 w-6 text-gray-600"})]}),o.jsxs("div",{className:"space-y-2 mb-4",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:["Mínimo: ",e.minPoints," puntos"]}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Descuento: ",e.discount,"%"]}),o.jsxs("p",{className:"text-lg font-bold",children:[e.count," miembros"]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Beneficios:"}),e.benefits.map((e,s)=>o.jsxs("p",{className:"text-xs text-gray-600",children:["• ",e]},s))]})]})},e.name)})}),o.jsxs(O,{children:[o.jsx(J,{children:o.jsx(W,{children:"Clientes por Nivel"})}),o.jsx(G,{children:o.jsx("div",{className:"space-y-4",children:S.map(s=>{const a=e.filter(e=>T(e.loyaltyPoints).name===s.name).sort((e,s)=>s.loyaltyPoints-e.loyaltyPoints).slice(0,5);return 0===a.length?null:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("h4",{className:"font-medium flex items-center",children:[o.jsx(K,{className:s.color,children:s.name}),o.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",a.length," clientes)"]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:a.map(e=>{const s=(a=e.loyaltyPoints,S.find(e=>a<e.minPoints)||null);var a;const l=s?s.minPoints-e.loyaltyPoints:0;return o.jsx("div",{className:"p-3 border rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-sm",children:e.name}),o.jsxs("p",{className:"text-xs text-gray-600",children:[e.loyaltyPoints," puntos"]}),s&&o.jsxs("p",{className:"text-xs text-blue-600",children:[l," para ",s.name]})]}),o.jsx(m,{className:"h-4 w-4 text-yellow-500"})]})},e.id)})})]},s.name)})})})]})]}),o.jsx(he,{value:"rewards",className:"space-y-6",children:o.jsxs(O,{children:[o.jsx(J,{children:o.jsxs(W,{className:"flex items-center justify-between",children:["Catálogo de Recompensas",o.jsxs(X,{children:[o.jsx(Y,{asChild:!0,children:o.jsxs(q,{children:[o.jsx(N,{className:"h-4 w-4 mr-2"}),"Nueva Recompensa"]})}),o.jsxs(Z,{children:[o.jsx(_,{children:o.jsx(Q,{children:"Crear Nueva Recompensa"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(U,{htmlFor:"reward-name",children:"Nombre"}),o.jsx($,{id:"reward-name",placeholder:"Nombre de la recompensa"})]}),o.jsxs("div",{children:[o.jsx(U,{htmlFor:"reward-points",children:"Costo en Puntos"}),o.jsx($,{id:"reward-points",type:"number",placeholder:"100"})]}),o.jsxs("div",{children:[o.jsx(U,{htmlFor:"reward-category",children:"Categoría"}),o.jsxs(ie,{children:[o.jsx(re,{children:o.jsx(ne,{placeholder:"Seleccionar categoría"})}),o.jsxs(ce,{children:[o.jsx(de,{value:"discount",children:"Descuento"}),o.jsx(de,{value:"product",children:"Producto"}),o.jsx(de,{value:"experience",children:"Experiencia"})]})]})]}),o.jsx(q,{children:"Crear Recompensa"})]})]})]})]})}),o.jsx(G,{children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{id:"1",name:"Descuento 10%",pointsCost:100,description:"10% de descuento en tu próxima compra",category:"discount",available:!0},{id:"2",name:"Producto Gratis",pointsCost:200,description:"Producto gratis hasta Bs. 15",category:"product",available:!0},{id:"3",name:"Descuento 20%",pointsCost:300,description:"20% de descuento en compras superiores a Bs. 100",category:"discount",available:!0},{id:"4",name:"Experiencia VIP",pointsCost:500,description:"Compra personal asistida y café gratis",category:"experience",available:!0,validUntil:"2024-12-31"}].map(e=>o.jsx(O,{className:"relative",children:o.jsxs(G,{className:"p-4",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center",children:["discount"===e.category&&o.jsx(y,{className:"h-5 w-5 text-green-600 mr-2"}),"product"===e.category&&o.jsx(f,{className:"h-5 w-5 text-blue-600 mr-2"}),"experience"===e.category&&o.jsx(h,{className:"h-5 w-5 text-purple-600 mr-2"}),o.jsx("h3",{className:"font-medium",children:e.name})]}),o.jsx(K,{variant:e.available?"default":"secondary",children:e.available?"Disponible":"Agotado"})]}),o.jsx("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(m,{className:"h-4 w-4 text-yellow-500 mr-1"}),o.jsxs("span",{className:"font-medium",children:[e.pointsCost," puntos"]})]}),e.validUntil&&o.jsxs("span",{className:"text-xs text-gray-500",children:["Válido hasta"," ",new Date(e.validUntil).toLocaleDateString()]})]})]})},e.id))})})]})}),o.jsx(he,{value:"management",className:"space-y-6",children:o.jsxs(O,{children:[o.jsx(J,{children:o.jsx(W,{children:"Ajustar Puntos de Cliente"})}),o.jsx(G,{children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(U,{htmlFor:"client-select",children:"Cliente"}),o.jsxs(ie,{value:x,onValueChange:C,children:[o.jsx(re,{children:o.jsx(ne,{placeholder:"Seleccionar cliente"})}),o.jsx(ce,{children:e.map(e=>o.jsxs(de,{value:e.id,children:[e.name," (",e.loyaltyPoints," puntos)"]},e.id))})]})]}),o.jsxs("div",{children:[o.jsx(U,{htmlFor:"points-adjustment",children:"Ajuste de Puntos"}),o.jsx($,{id:"points-adjustment",type:"number",placeholder:"100 (positivo para agregar, negativo para restar)",value:t,onChange:e=>i(e.target.value)})]}),o.jsxs("div",{children:[o.jsx(U,{htmlFor:"adjustment-reason",children:"Motivo del Ajuste"}),o.jsx($,{id:"adjustment-reason",placeholder:"Describe el motivo del ajuste",value:r,onChange:e=>d(e.target.value)})]}),o.jsxs(q,{onClick:()=>{if(!x||!t||!r)return void P({title:"Error",description:"Completa todos los campos",variant:"destructive"});const a=e.find(e=>e.id===x);if(!a)return;const l=parseInt(t),n=Math.max(0,a.loyaltyPoints+l),c=T(n);s(x,{loyaltyPoints:n,tier:c.name.toLowerCase()}),P({title:"Puntos ajustados",description:`Se ${l>0?"agregaron":"restaron"} ${Math.abs(l)} puntos`}),C(""),i(""),d("")},disabled:!x||!t||!r,children:[o.jsx(b,{className:"h-4 w-4 mr-2"}),"Aplicar Ajuste"]})]}),x&&o.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:(()=>{const s=e.find(e=>e.id===x);if(!s)return null;const a=T(s.loyaltyPoints),l=parseInt(t)||0,i=Math.max(0,s.loyaltyPoints+l),r=T(i);return o.jsxs("div",{className:"space-y-3",children:[o.jsx("h4",{className:"font-medium",children:"Vista Previa del Cambio"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Puntos actuales:"}),o.jsx("span",{className:"font-medium",children:s.loyaltyPoints})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Ajuste:"}),o.jsxs("span",{className:"font-medium "+(l>=0?"text-green-600":"text-red-600"),children:[l>=0?"+":"",l]})]}),o.jsxs("div",{className:"flex justify-between border-t pt-2",children:[o.jsx("span",{children:"Nuevos puntos:"}),o.jsx("span",{className:"font-bold",children:i})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Nivel actual:"}),o.jsx(K,{className:a.color,children:a.name})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Nuevo nivel:"}),o.jsxs(K,{className:r.color,children:[r.name,r.name!==a.name&&o.jsx("span",{className:"ml-1",children:"🎉"})]})]})]})]})})()})]})})]})}),o.jsx(he,{value:"history",className:"space-y-6",children:o.jsxs(O,{children:[o.jsx(J,{children:o.jsxs(W,{className:"flex items-center",children:[o.jsx(w,{className:"h-5 w-5 mr-2"}),"Historial de Puntos"]})}),o.jsx(G,{children:o.jsxs(je,{children:[o.jsx(ue,{children:o.jsxs(pe,{children:[o.jsx(ge,{children:"Cliente"}),o.jsx(ge,{children:"Tipo"}),o.jsx(ge,{children:"Puntos"}),o.jsx(ge,{children:"Descripción"}),o.jsx(ge,{children:"Fecha"})]})}),o.jsx(ve,{children:D.map(e=>o.jsxs(pe,{children:[o.jsx(Ne,{className:"font-medium",children:e.clientName}),o.jsx(Ne,{children:o.jsxs(K,{variant:"earned"===e.type?"default":"redeemed"===e.type?"secondary":"destructive",children:["earned"===e.type&&"Ganados","redeemed"===e.type&&"Canjeados","expired"===e.type&&"Expirados","adjusted"===e.type&&"Ajustados"]})}),o.jsx(Ne,{children:o.jsxs("span",{className:e.points>=0?"text-green-600":"text-red-600",children:[e.points>=0?"+":"",e.points]})}),o.jsx(Ne,{children:e.description}),o.jsx(Ne,{children:new Date(e.date).toLocaleDateString()})]},e.id))})]})})]})})]})]})},Ue=({clients:e})=>{const[s,a]=R.useState("last30days"),[l,t]=R.useState("sales"),i=Array.from({length:30},(e,s)=>{const a=new Date;return a.setDate(a.getDate()-(29-s)),{date:a.toISOString().split("T")[0],day:a.toLocaleDateString("es-ES",{weekday:"short"}),sales:Math.floor(5e3*Math.random())+2e3,transactions:Math.floor(50*Math.random())+20,customers:Math.floor(30*Math.random())+15}}),r=[{name:"Lácteos",value:25,color:"#8884d8"},{name:"Panadería",value:20,color:"#82ca9d"},{name:"Frutas",value:15,color:"#ffc658"},{name:"Carnes",value:18,color:"#ff7300"},{name:"Bebidas",value:12,color:"#00ff00"},{name:"Limpieza",value:10,color:"#ff0000"}],n={totalRevenue:e.reduce((e,s)=>e+s.totalSpent,0),totalTransactions:e.reduce((e,s)=>e+s.totalPurchases,0),averageTicket:e.reduce((e,s)=>e+s.averageTicket,0)/e.length||0,repeatCustomers:e.filter(e=>e.totalPurchases>1).length,revenueGrowth:12.5,transactionGrowth:8.3,customerGrowth:15.2},c=e.sort((e,s)=>s.totalSpent-e.totalSpent).slice(0,10),d=[{segment:"Nuevos Clientes",count:e.filter(e=>{const s=new Date(e.registrationDate),a=new Date;return a.setDate(a.getDate()-30),s>a}).length,percentage:15,color:"bg-blue-100 text-blue-800"},{segment:"Clientes Regulares",count:e.filter(e=>e.totalPurchases>=5&&e.totalPurchases<=20).length,percentage:45,color:"bg-green-100 text-green-800"},{segment:"Clientes VIP",count:e.filter(e=>e.totalPurchases>20).length,percentage:25,color:"bg-purple-100 text-purple-800"},{segment:"Clientes Inactivos",count:e.filter(e=>{if(!e.lastPurchase)return!0;const s=new Date(e.lastPurchase),a=new Date;return a.setDate(a.getDate()-60),s<a}).length,percentage:15,color:"bg-gray-100 text-gray-800"}];return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(C,{className:"h-8 w-8 text-green-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ingresos Totales"}),o.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["Bs. ",n.totalRevenue.toFixed(2)]}),o.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[o.jsx(g,{className:"h-3 w-3 mr-1"}),"+",n.revenueGrowth,"%"]})]})]})})}),o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(P,{className:"h-8 w-8 text-blue-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Transacciones"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.totalTransactions}),o.jsxs("p",{className:"text-sm text-blue-600 flex items-center",children:[o.jsx(g,{className:"h-3 w-3 mr-1"}),"+",n.transactionGrowth,"%"]})]})]})})}),o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(S,{className:"h-8 w-8 text-purple-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ticket Promedio"}),o.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["Bs. ",n.averageTicket.toFixed(2)]}),o.jsx("p",{className:"text-sm text-gray-600",children:"Por transacción"})]})]})})}),o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(p,{className:"h-8 w-8 text-orange-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Clientes Recurrentes"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.repeatCustomers}),o.jsxs("p",{className:"text-sm text-orange-600 flex items-center",children:[o.jsx(g,{className:"h-3 w-3 mr-1"}),"+",n.customerGrowth,"%"]})]})]})})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs(O,{children:[o.jsx(J,{children:o.jsxs(W,{className:"flex items-center justify-between",children:[o.jsx("span",{children:"Tendencia de Ventas"}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsxs(ie,{value:s,onValueChange:a,children:[o.jsx(re,{className:"w-32",children:o.jsx(ne,{})}),o.jsxs(ce,{children:[o.jsx(de,{value:"last7days",children:"7 días"}),o.jsx(de,{value:"last30days",children:"30 días"}),o.jsx(de,{value:"last90days",children:"90 días"})]})]})})]})}),o.jsx(G,{children:o.jsx(De,{width:"100%",height:300,children:o.jsxs(Te,{data:i,children:[o.jsx(ke,{strokeDasharray:"3 3"}),o.jsx(Ae,{dataKey:"day"}),o.jsx(Ee,{}),o.jsx(Fe,{formatter:(e,s)=>["sales"===s?`Bs. ${e}`:e,"sales"===s?"Ventas":"Transacciones"]}),o.jsx(Me,{type:"monotone",dataKey:"sales",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.3})]})})})]}),o.jsxs(O,{children:[o.jsx(J,{children:o.jsx(W,{children:"Distribución por Categorías"})}),o.jsx(G,{children:o.jsx(De,{width:"100%",height:300,children:o.jsxs(Le,{children:[o.jsx(ze,{data:r,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:s})=>`${e} ${(100*s).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:r.map((e,s)=>o.jsx(Ve,{fill:e.color},`cell-${s}`))}),o.jsx(Fe,{})]})})})]})]}),o.jsxs(O,{children:[o.jsx(J,{children:o.jsx(W,{children:"Segmentación de Clientes"})}),o.jsx(G,{children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:d.map((e,s)=>o.jsxs("div",{className:"p-4 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx(K,{className:e.color,children:e.segment}),o.jsx("span",{className:"text-lg font-bold",children:e.count})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${e.percentage}%`}})}),o.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[e.percentage,"% del total"]})]},s))})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs(O,{children:[o.jsx(J,{children:o.jsxs(W,{className:"flex items-center",children:[o.jsx(h,{className:"h-5 w-5 mr-2"}),"Top 10 Clientes"]})}),o.jsx(G,{children:o.jsxs(je,{children:[o.jsx(ue,{children:o.jsxs(pe,{children:[o.jsx(ge,{children:"Cliente"}),o.jsx(ge,{children:"Compras"}),o.jsx(ge,{children:"Total Gastado"})]})}),o.jsx(ve,{children:c.map((e,s)=>o.jsxs(pe,{children:[o.jsx(Ne,{children:o.jsxs("div",{className:"flex items-center",children:[o.jsxs("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white text-sm font-bold mr-3",children:["#",s+1]}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:e.name}),o.jsx("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),o.jsx(Ne,{children:o.jsx(K,{variant:"outline",children:e.totalPurchases})}),o.jsxs(Ne,{className:"font-medium",children:["Bs. ",e.totalSpent.toFixed(2)]})]},e.id))})]})})]}),o.jsxs(O,{children:[o.jsx(J,{children:o.jsxs(W,{className:"flex items-center justify-between",children:[o.jsxs("span",{className:"flex items-center",children:[o.jsx(D,{className:"h-5 w-5 mr-2"}),"Compras Recientes"]}),o.jsxs(q,{variant:"outline",size:"sm",children:[o.jsx(T,{className:"h-4 w-4 mr-2"}),"Exportar"]})]})}),o.jsx(G,{children:o.jsx("div",{className:"space-y-4",children:[{id:"1",customer:"María González",amount:85.5,items:12,date:"2024-11-29",time:"14:30",category:"Supermercado"},{id:"2",customer:"Carlos Rodríguez",amount:42.25,items:7,date:"2024-11-29",time:"12:15",category:"Panadería"},{id:"3",customer:"Ana Martínez",amount:126.75,items:18,date:"2024-11-29",time:"10:45",category:"Supermercado"}].map(e=>o.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:o.jsx(P,{className:"h-5 w-5 text-green-600"})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:e.customer}),o.jsxs("div",{className:"text-sm text-gray-500",children:[e.items," artículos • ",e.category]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"font-bold",children:["Bs. ",e.amount]}),o.jsxs("div",{className:"text-sm text-gray-500",children:[e.date," ",e.time]})]})]},e.id))})})]})]}),o.jsxs(O,{children:[o.jsx(J,{children:o.jsx(W,{children:"Volumen de Transacciones por Día"})}),o.jsx(G,{children:o.jsx(De,{width:"100%",height:300,children:o.jsxs(Ie,{data:i,children:[o.jsx(ke,{strokeDasharray:"3 3"}),o.jsx(Ae,{dataKey:"day"}),o.jsx(Ee,{}),o.jsx(Fe,{}),o.jsx(Be,{dataKey:"transactions",fill:"#82ca9d"})]})})})]})]})},$e=({clients:e,onUpdate:s,onDelete:a,loading:l})=>{const[t,i]=R.useState(""),[r,n]=R.useState("all"),[c,d]=R.useState("all"),[x,h]=R.useState("name"),[j,u]=R.useState("asc"),[p,g]=R.useState(1),v=e=>{switch(e){case"platinum":return"bg-purple-100 text-purple-800";case"gold":return"bg-yellow-100 text-yellow-800";case"silver":return"bg-gray-100 text-gray-800";default:return"bg-orange-100 text-orange-800"}},N=e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"vip":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},y=B.useMemo(()=>{let s=e.filter(e=>{const s=e.name.toLowerCase().includes(t.toLowerCase())||e.email.toLowerCase().includes(t.toLowerCase())||e.phone.includes(t),a="all"===r||e.status===r,l="all"===c||e.tier===c;return s&&a&&l});return s.sort((e,s)=>{let a,l;switch(x){case"name":default:a=e.name.toLowerCase(),l=s.name.toLowerCase();break;case"registrationDate":a=new Date(e.registrationDate).getTime(),l=new Date(s.registrationDate).getTime();break;case"totalSpent":a=e.totalSpent,l=s.totalSpent;break;case"loyaltyPoints":a=e.loyaltyPoints,l=s.loyaltyPoints;break;case"lastPurchase":a=new Date(e.lastPurchase||0).getTime(),l=new Date(s.lastPurchase||0).getTime()}return"asc"===j?a<l?-1:a>l?1:0:a>l?-1:a<l?1:0}),s},[e,t,r,c,x,j]),b=Math.ceil(y.length/10),w=y.slice(10*(p-1),10*p),C=e=>{x===e?u("asc"===j?"desc":"asc"):(h(e),u("asc"))};return o.jsxs(O,{children:[o.jsx(J,{children:o.jsxs(W,{className:"flex items-center justify-between",children:[o.jsx("span",{children:"Lista Completa de Clientes"}),o.jsxs(q,{onClick:()=>{const e=[["Nombre","Email","Teléfono","Estado","Nivel","Puntos","Total Gastado"].join(","),...y.map(e=>[`"${e.name}"`,`"${e.email}"`,`"${e.phone}"`,`"${e.status}"`,`"${e.tier}"`,e.loyaltyPoints,e.totalSpent.toFixed(2)].join(","))].join("\n"),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(s),a.download=`clientes_${(new Date).toISOString().split("T")[0]}.csv`,a.click()},variant:"outline",children:[o.jsx(T,{className:"h-4 w-4 mr-2"}),"Exportar CSV"]})]})}),o.jsxs(G,{children:[o.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),o.jsx($,{placeholder:"Buscar por nombre, email o teléfono...",value:t,onChange:e=>i(e.target.value),className:"pl-10"})]}),o.jsxs(ie,{value:r,onValueChange:n,children:[o.jsx(re,{className:"w-full lg:w-48",children:o.jsx(ne,{placeholder:"Estado"})}),o.jsxs(ce,{children:[o.jsx(de,{value:"all",children:"Todos los estados"}),o.jsx(de,{value:"active",children:"Activo"}),o.jsx(de,{value:"inactive",children:"Inactivo"}),o.jsx(de,{value:"vip",children:"VIP"})]})]}),o.jsxs(ie,{value:c,onValueChange:d,children:[o.jsx(re,{className:"w-full lg:w-48",children:o.jsx(ne,{placeholder:"Nivel"})}),o.jsxs(ce,{children:[o.jsx(de,{value:"all",children:"Todos los niveles"}),o.jsx(de,{value:"bronze",children:"Bronce"}),o.jsx(de,{value:"silver",children:"Plata"}),o.jsx(de,{value:"gold",children:"Oro"}),o.jsx(de,{value:"platinum",children:"Platino"})]})]}),o.jsxs(ie,{value:x,onValueChange:h,children:[o.jsx(re,{className:"w-full lg:w-48",children:o.jsx(ne,{placeholder:"Ordenar por"})}),o.jsxs(ce,{children:[o.jsx(de,{value:"name",children:"Nombre"}),o.jsx(de,{value:"registrationDate",children:"Fecha de Registro"}),o.jsx(de,{value:"lastPurchase",children:"Última Compra"}),o.jsx(de,{value:"totalSpent",children:"Total Gastado"}),o.jsx(de,{value:"loyaltyPoints",children:"Puntos de Fidelidad"})]})]})]}),o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:["Mostrando ",w.length," de"," ",y.length," clientes"]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Página:"}),o.jsxs(ie,{value:p.toString(),onValueChange:e=>g(parseInt(e)),children:[o.jsx(re,{className:"w-20",children:o.jsx(ne,{})}),o.jsx(ce,{children:Array.from({length:b},(e,s)=>s+1).map(e=>o.jsx(de,{value:e.toString(),children:e},e))})]}),o.jsxs("span",{className:"text-sm text-gray-600",children:["de ",b]})]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs(je,{children:[o.jsx(ue,{children:o.jsxs(pe,{children:[o.jsxs(ge,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>C("name"),children:["Cliente"," ","name"===x&&("asc"===j?"↑":"↓")]}),o.jsx(ge,{children:"Contacto"}),o.jsx(ge,{children:"Estado & Nivel"}),o.jsxs(ge,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>C("loyaltyPoints"),children:["Puntos"," ","loyaltyPoints"===x&&("asc"===j?"↑":"↓")]}),o.jsxs(ge,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>C("totalSpent"),children:["Gastos"," ","totalSpent"===x&&("asc"===j?"↑":"↓")]}),o.jsxs(ge,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>C("lastPurchase"),children:["Última Compra"," ","lastPurchase"===x&&("asc"===j?"↑":"↓")]}),o.jsx(ge,{children:"Acciones"})]})}),o.jsx(ve,{children:l?o.jsx(pe,{children:o.jsx(Ne,{colSpan:7,className:"text-center py-8",children:o.jsxs("div",{className:"flex items-center justify-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),o.jsx("span",{className:"ml-2",children:"Cargando clientes..."})]})})}):0===w.length?o.jsx(pe,{children:o.jsx(Ne,{colSpan:7,className:"text-center py-8",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx(k,{className:"h-12 w-12 text-gray-400 mb-2"}),o.jsx("p",{className:"text-gray-500",children:"No se encontraron clientes"}),o.jsx("p",{className:"text-sm text-gray-400",children:"Intenta ajustar los filtros de búsqueda"})]})})}):w.map(e=>o.jsxs(pe,{className:"hover:bg-gray-50",children:[o.jsx(Ne,{children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center",children:o.jsx("span",{className:"text-white font-medium text-sm",children:e.name.split(" ").map(e=>e[0]).join("").substring(0,2)})})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:e.name}),o.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[o.jsx(A,{className:"h-3 w-3 mr-1"}),"Desde"," ",new Date(e.registrationDate).toLocaleDateString()]})]})]})}),o.jsx(Ne,{children:o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex items-center text-sm",children:[o.jsx(E,{className:"h-3 w-3 mr-2 text-gray-400"}),e.email]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[o.jsx(F,{className:"h-3 w-3 mr-2 text-gray-400"}),e.phone]})]})}),o.jsx(Ne,{children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs(K,{className:N(e.status),children:["active"===e.status&&"Activo","inactive"===e.status&&"Inactivo","vip"===e.status&&"VIP"]}),o.jsx(K,{className:v(e.tier),children:e.tier.charAt(0).toUpperCase()+e.tier.slice(1)})]})}),o.jsx(Ne,{children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(m,{className:"h-4 w-4 text-yellow-500 mr-2"}),o.jsx("span",{className:"font-medium",children:e.loyaltyPoints})]})}),o.jsx(Ne,{children:o.jsxs("div",{children:[o.jsxs("div",{className:"font-medium",children:["Bs. ",e.totalSpent.toFixed(2)]}),o.jsxs("div",{className:"text-sm text-gray-500",children:[e.totalPurchases," compras"]})]})}),o.jsx(Ne,{children:o.jsx("div",{className:"text-sm",children:e.lastPurchase?o.jsxs(o.Fragment,{children:[o.jsx("div",{children:new Date(e.lastPurchase).toLocaleDateString()}),o.jsxs("div",{className:"text-gray-500",children:[Math.floor((Date.now()-new Date(e.lastPurchase).getTime())/864e5)," ","días"]})]}):o.jsx("span",{className:"text-gray-400",children:"Sin compras"})})}),o.jsx(Ne,{children:o.jsxs(ee,{children:[o.jsx(se,{asChild:!0,children:o.jsx(q,{variant:"ghost",size:"sm",children:o.jsx(M,{className:"h-4 w-4"})})}),o.jsxs(ae,{align:"end",children:[o.jsxs(le,{children:[o.jsx(L,{className:"h-4 w-4 mr-2"}),"Ver Detalles"]}),o.jsxs(le,{children:[o.jsx(z,{className:"h-4 w-4 mr-2"}),"Editar"]}),o.jsxs(le,{children:[o.jsx(f,{className:"h-4 w-4 mr-2"}),"Otorgar Puntos"]}),o.jsxs(le,{children:[o.jsx(E,{className:"h-4 w-4 mr-2"}),"Enviar Email"]}),o.jsxs(le,{className:"text-red-600",onClick:()=>a(e.id),children:[o.jsx(V,{className:"h-4 w-4 mr-2"}),"Eliminar"]})]})]})})]},e.id))})]})}),b>1&&o.jsxs("div",{className:"flex items-center justify-between mt-6",children:[o.jsx(q,{variant:"outline",size:"sm",onClick:()=>g(Math.max(1,p-1)),disabled:1===p,children:"Anterior"}),o.jsx("div",{className:"flex items-center space-x-2",children:Array.from({length:Math.min(5,b)},(e,s)=>{const a=s+Math.max(1,p-2);return a>b?null:o.jsx(q,{variant:p===a?"default":"outline",size:"sm",onClick:()=>g(a),children:a},a)})}),o.jsx(q,{variant:"outline",size:"sm",onClick:()=>g(Math.min(b,p+1)),disabled:p===b,children:"Siguiente"})]})]})]})},Ke=()=>{const[e,s]=R.useState([]),[a,l]=R.useState(!0),[t,i]=R.useState(""),[r,c]=R.useState("all"),[x,j]=R.useState("all"),[u,v]=R.useState(null),[y,b]=R.useState(!1),[w,C]=R.useState("overview"),{toast:P}=H(),[S,D]=R.useState({totalClients:0,activeClients:0,vipClients:0,newThisMonth:0,avgLoyaltyPoints:0,avgPurchaseValue:0});R.useEffect(()=>{T(),M()},[]);const T=()=>d(null,null,function*(){l(!0);try{s([{id:"1",name:"María González",email:"maria@email.com",phone:"+584241234567",address:"Av. Principal 123, Valencia",registrationDate:"2024-01-15",lastPurchase:"2024-11-28",totalPurchases:45,loyaltyPoints:1250,status:"active",tier:"gold",birthday:"1985-06-15",preferences:["lácteos","panadería","frutas"],totalSpent:2340.5,averageTicket:52.01,purchaseFrequency:15},{id:"2",name:"Carlos Rodríguez",email:"carlos@email.com",phone:"+584129876543",address:"Calle 5 #45-67, Maracay",registrationDate:"2024-03-20",lastPurchase:"2024-11-25",totalPurchases:23,loyaltyPoints:680,status:"active",tier:"silver",birthday:"1978-11-03",preferences:["carnes","bebidas","limpieza"],totalSpent:1120.75,averageTicket:48.73,purchaseFrequency:8},{id:"3",name:"Ana Martínez",email:"ana@email.com",phone:"+584167890123",address:"Urbanización Los Alamos, Casa 12",registrationDate:"2023-11-10",lastPurchase:"2024-11-29",totalPurchases:78,loyaltyPoints:2150,status:"vip",tier:"platinum",birthday:"1990-03-22",preferences:["productos orgánicos","vinos","gourmet"],totalSpent:4567.3,averageTicket:58.55,purchaseFrequency:25}])}catch(e){P({title:"Error",description:"No se pudieron cargar los clientes",variant:"destructive"})}finally{l(!1)}}),M=()=>d(null,null,function*(){try{D({totalClients:1247,activeClients:1150,vipClients:67,newThisMonth:45,avgLoyaltyPoints:890,avgPurchaseValue:52.4})}catch(e){}}),B=(a,l)=>d(null,null,function*(){try{const t=e.map(e=>e.id===a?n(n({},e),l):e);s(t),v(null),P({title:"Cliente actualizado",description:"Los datos del cliente han sido actualizados"})}catch(t){P({title:"Error",description:"No se pudo actualizar el cliente",variant:"destructive"})}}),U=a=>d(null,null,function*(){try{s(e.filter(e=>e.id!==a)),P({title:"Cliente eliminado",description:"El cliente ha sido eliminado del sistema"})}catch(l){P({title:"Error",description:"No se pudo eliminar el cliente",variant:"destructive"})}}),ee=e.filter(e=>{const s=e.name.toLowerCase().includes(t.toLowerCase())||e.email.toLowerCase().includes(t.toLowerCase())||e.phone.includes(t),a="all"===r||e.status===r,l="all"===x||e.tier===x;return s&&a&&l}),se=e=>{switch(e){case"platinum":return"bg-purple-100 text-purple-800";case"gold":return"bg-yellow-100 text-yellow-800";case"silver":return"bg-gray-100 text-gray-800";default:return"bg-orange-100 text-orange-800"}},ae=e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"vip":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};return o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx(te,{}),o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Gestión de Clientes"}),o.jsx("p",{className:"text-gray-600",children:"Administra tu base de clientes y programa de fidelidad"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6 mb-8",children:[o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(p,{className:"h-8 w-8 text-blue-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Clientes"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.totalClients})]})]})})}),o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(g,{className:"h-8 w-8 text-green-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Clientes Activos"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.activeClients})]})]})})}),o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(h,{className:"h-8 w-8 text-purple-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Clientes VIP"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.vipClients})]})]})})}),o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(A,{className:"h-8 w-8 text-orange-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Nuevos (Mes)"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.newThisMonth})]})]})})}),o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(m,{className:"h-8 w-8 text-yellow-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Puntos Promedio"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.avgLoyaltyPoints})]})]})})}),o.jsx(O,{children:o.jsx(G,{className:"p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(f,{className:"h-8 w-8 text-red-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ticket Promedio"}),o.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["Bs. ",S.avgPurchaseValue]})]})]})})})]}),o.jsxs(oe,{value:w,onValueChange:C,className:"space-y-6",children:[o.jsxs(xe,{className:"grid w-full grid-cols-4",children:[o.jsx(me,{value:"overview",children:"Resumen"}),o.jsx(me,{value:"clients",children:"Lista de Clientes"}),o.jsx(me,{value:"loyalty",children:"Programa de Fidelidad"}),o.jsx(me,{value:"analytics",children:"Analíticas"})]}),o.jsx(he,{value:"overview",className:"space-y-6",children:o.jsxs(O,{children:[o.jsx(J,{children:o.jsxs(W,{className:"flex items-center justify-between",children:[o.jsx("span",{children:"Clientes Recientes"}),o.jsxs(X,{open:y,onOpenChange:b,children:[o.jsx(Y,{asChild:!0,children:o.jsxs(q,{children:[o.jsx(N,{className:"h-4 w-4 mr-2"}),"Nuevo Cliente"]})}),o.jsxs(Z,{className:"max-w-2xl",children:[o.jsx(_,{children:o.jsx(Q,{children:"Registrar Nuevo Cliente"})}),o.jsx(Oe,{onSubmit:a=>d(null,null,function*(){try{const l=n({id:Date.now().toString(),name:a.name||"",email:a.email||"",phone:a.phone||"",address:a.address||"",registrationDate:(new Date).toISOString().split("T")[0],lastPurchase:"",totalPurchases:0,loyaltyPoints:0,status:"active",tier:"bronze",preferences:[],totalSpent:0,averageTicket:0,purchaseFrequency:0},a);s([...e,l]),b(!1),P({title:"Cliente creado",description:"El cliente ha sido registrado exitosamente"})}catch(l){P({title:"Error",description:"No se pudo crear el cliente",variant:"destructive"})}}),onCancel:()=>b(!1)})]})]})]})}),o.jsxs(G,{children:[o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),o.jsx($,{placeholder:"Buscar clientes...",value:t,onChange:e=>i(e.target.value),className:"pl-10"})]}),o.jsxs(ie,{value:r,onValueChange:c,children:[o.jsx(re,{className:"w-full sm:w-48",children:o.jsx(ne,{placeholder:"Estado"})}),o.jsxs(ce,{children:[o.jsx(de,{value:"all",children:"Todos los estados"}),o.jsx(de,{value:"active",children:"Activo"}),o.jsx(de,{value:"inactive",children:"Inactivo"}),o.jsx(de,{value:"vip",children:"VIP"})]})]}),o.jsxs(ie,{value:x,onValueChange:j,children:[o.jsx(re,{className:"w-full sm:w-48",children:o.jsx(ne,{placeholder:"Nivel"})}),o.jsxs(ce,{children:[o.jsx(de,{value:"all",children:"Todos los niveles"}),o.jsx(de,{value:"bronze",children:"Bronce"}),o.jsx(de,{value:"silver",children:"Plata"}),o.jsx(de,{value:"gold",children:"Oro"}),o.jsx(de,{value:"platinum",children:"Platino"})]})]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs(je,{children:[o.jsx(ue,{children:o.jsxs(pe,{children:[o.jsx(ge,{children:"Cliente"}),o.jsx(ge,{children:"Contacto"}),o.jsx(ge,{children:"Estado"}),o.jsx(ge,{children:"Nivel"}),o.jsx(ge,{children:"Puntos"}),o.jsx(ge,{children:"Total Gastado"}),o.jsx(ge,{children:"Acciones"})]})}),o.jsx(ve,{children:a?o.jsx(pe,{children:o.jsx(Ne,{colSpan:7,className:"text-center py-8",children:"Cargando clientes..."})}):0===ee.length?o.jsx(pe,{children:o.jsx(Ne,{colSpan:7,className:"text-center py-8",children:"No se encontraron clientes"})}):ee.slice(0,10).map(e=>o.jsxs(pe,{children:[o.jsx(Ne,{children:o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:e.name}),o.jsxs("div",{className:"text-sm text-gray-500",children:["Registrado:"," ",new Date(e.registrationDate).toLocaleDateString()]})]})}),o.jsx(Ne,{children:o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center text-sm",children:[o.jsx(E,{className:"h-3 w-3 mr-1"}),e.email]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[o.jsx(F,{className:"h-3 w-3 mr-1"}),e.phone]})]})}),o.jsx(Ne,{children:o.jsxs(K,{className:ae(e.status),children:["active"===e.status&&"Activo","inactive"===e.status&&"Inactivo","vip"===e.status&&"VIP"]})}),o.jsx(Ne,{children:o.jsx(K,{className:se(e.tier),children:e.tier.charAt(0).toUpperCase()+e.tier.slice(1)})}),o.jsx(Ne,{children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(m,{className:"h-4 w-4 text-yellow-500 mr-1"}),e.loyaltyPoints]})}),o.jsxs(Ne,{children:["Bs. ",e.totalSpent.toFixed(2)]}),o.jsx(Ne,{children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(q,{variant:"ghost",size:"sm",onClick:()=>v(e),children:o.jsx(L,{className:"h-4 w-4"})}),o.jsx(q,{variant:"ghost",size:"sm",onClick:()=>{v(e),b(!0)},children:o.jsx(z,{className:"h-4 w-4"})}),o.jsx(q,{variant:"ghost",size:"sm",onClick:()=>U(e.id),children:o.jsx(V,{className:"h-4 w-4"})})]})})]},e.id))})]})})]})]})}),o.jsx(he,{value:"clients",children:o.jsx($e,{clients:ee,onUpdate:B,onDelete:U,loading:a})}),o.jsx(he,{value:"loyalty",children:o.jsx(Ge,{clients:e,onUpdateClient:B})}),o.jsx(he,{value:"analytics",children:o.jsx(Ue,{clients:e})})]}),u&&!y&&o.jsx(X,{open:!!u,onOpenChange:()=>v(null),children:o.jsxs(Z,{className:"max-w-4xl",children:[o.jsx(_,{children:o.jsxs(Q,{className:"flex items-center",children:[o.jsx(p,{className:"h-5 w-5 mr-2"}),"Detalles del Cliente"]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold",children:u.name}),o.jsx(K,{className:ae(u.status),children:u.status}),o.jsx(K,{className:se(u.tier),style:{marginLeft:"8px"},children:u.tier})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(E,{className:"h-4 w-4 mr-2 text-gray-500"}),u.email]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx(F,{className:"h-4 w-4 mr-2 text-gray-500"}),u.phone]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx(I,{className:"h-4 w-4 mr-2 text-gray-500"}),u.address]})]})]}),o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:u.totalPurchases}),o.jsx("div",{className:"text-sm text-gray-600",children:"Compras"})]}),o.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:u.loyaltyPoints}),o.jsx("div",{className:"text-sm text-gray-600",children:"Puntos"})]}),o.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[o.jsxs("div",{className:"text-2xl font-bold text-yellow-600",children:["Bs. ",u.totalSpent.toFixed(2)]}),o.jsx("div",{className:"text-sm text-gray-600",children:"Total Gastado"})]}),o.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[o.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["Bs. ",u.averageTicket.toFixed(2)]}),o.jsx("div",{className:"text-sm text-gray-600",children:"Ticket Promedio"})]})]})})]})]})})]})]})};export{Ke as default};
