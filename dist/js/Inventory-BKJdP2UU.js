var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,i=(s,a,r)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r,l=(e,s)=>{for(var a in s||(s={}))t.call(s,a)&&i(e,a,s[a]);if(r)for(var a of r(s))c.call(s,a)&&i(e,a,s[a]);return e},o=(e,r)=>s(e,a(r)),n=(e,s,a)=>new Promise((r,t)=>{var c=e=>{try{l(a.next(e))}catch(s){t(s)}},i=e=>{try{l(a.throw(e))}catch(s){t(s)}},l=e=>e.done?r(e.value):Promise.resolve(e.value).then(c,i);l((a=a.apply(e,s)).next())});import{j as d,aC as u,av as m,aW as h,aA as x,m as p,aa as j,br as g}from"./chunk-D1ivKm1I.js";import{a as v}from"./chunk-CNNdbZTC.js";import{p as y,C as N,n as f,o as k,e as b,L as w,I as C,B as _,b as S,D as E,r as P,t as q,v as F,q as z}from"./index-17eEFbcJ.js";import{S as I,a as O,b as A,c as $,d as T}from"./chunk-DQJYHBrk.js";import{A as B,a as D}from"./chunk-Cw3qc0hc.js";import{T as M}from"./chunk-DtJU0gqK.js";import{S as U}from"./chunk-Z0RKkQGX.js";import{S as V}from"./chunk-BZj8Mp6R.js";import"./chunk-DGERTDnL.js";import"./chunk-BdChqvju.js";import"./chunk-B5XYL1Sr.js";const G=({product:e,categories:s,onSave:a,onCancel:r})=>{const[t,c]=v.useState({name:"",description:"",price:"",cost:"",sku:"",barcode:"",category_id:"",stock_quantity:"",min_stock:"10",unit:"unidad",brand:"",supplier:"",expiry_date:"",is_active:!0}),[i,u]=v.useState(!1),{toast:m}=y();v.useEffect(()=>{var s,a,r,t,i,l;e&&c({name:e.name||"",description:e.description||"",price:(null==(s=e.price)?void 0:s.toString())||"",cost:(null==(a=e.cost)?void 0:a.toString())||"",sku:e.sku||"",barcode:e.barcode||"",category_id:(null==(r=e.categories)?void 0:r.id)||"",stock_quantity:(null==(t=e.stock_quantity)?void 0:t.toString())||"",min_stock:(null==(i=e.min_stock)?void 0:i.toString())||"10",unit:e.unit||"unidad",brand:e.brand||"",supplier:e.supplier||"",expiry_date:e.expiry_date?e.expiry_date.split("T")[0]:"",is_active:null==(l=e.is_active)||l})},[e]);const h=(e,s)=>{c(a=>o(l({},a),{[e]:s}))};return d.jsxs("form",{onSubmit:s=>n(null,null,function*(){if(s.preventDefault(),t.name&&t.price&&t.category_id&&t.stock_quantity){u(!0);try{const s=localStorage.getItem("token"),r=e?`/api/products/${e.id}`:"/api/products",c=e?"PUT":"POST",i=o(l({},t),{price:parseFloat(t.price),cost:t.cost?parseFloat(t.cost):null,stock_quantity:parseInt(t.stock_quantity),min_stock:parseInt(t.min_stock),expiry_date:t.expiry_date||null}),n=yield fetch(r,{method:c,headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(i)});if(!n.ok){const e=yield n.json();throw new Error(e.error||"Error al guardar producto")}m({title:"Éxito",description:e?"Producto actualizado exitosamente":"Producto creado exitosamente"}),a()}catch(r){m({title:"Error",description:r instanceof Error?r.message:"Error al guardar producto",variant:"destructive"})}finally{u(!1)}}else m({title:"Error",description:"Por favor completa todos los campos requeridos",variant:"destructive"})}),className:"space-y-6",children:[d.jsxs(N,{children:[d.jsx(f,{children:d.jsx(k,{className:"text-lg",children:"Información Básica"})}),d.jsxs(b,{className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsxs(w,{htmlFor:"name",children:["Nombre del Producto ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx(C,{id:"name",value:t.name,onChange:e=>h("name",e.target.value),placeholder:"Nombre del producto",required:!0})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs(w,{htmlFor:"category_id",children:["Categoría ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsxs(I,{value:t.category_id,onValueChange:e=>h("category_id",e),children:[d.jsx(O,{children:d.jsx(A,{placeholder:"Seleccionar categoría"})}),d.jsx($,{children:s.map(e=>d.jsx(T,{value:e.id,children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),e.name]})},e.id))})]})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(w,{htmlFor:"description",children:"Descripción"}),d.jsx(M,{id:"description",value:t.description,onChange:e=>h("description",e.target.value),placeholder:"Descripción del producto",rows:3})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(w,{htmlFor:"brand",children:"Marca"}),d.jsx(C,{id:"brand",value:t.brand,onChange:e=>h("brand",e.target.value),placeholder:"Marca del producto"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(w,{htmlFor:"supplier",children:"Proveedor"}),d.jsx(C,{id:"supplier",value:t.supplier,onChange:e=>h("supplier",e.target.value),placeholder:"Proveedor"})]})]})]})]}),d.jsxs(N,{children:[d.jsx(f,{children:d.jsx(k,{className:"text-lg",children:"Precios"})}),d.jsx(b,{className:"space-y-4",children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsxs(w,{htmlFor:"price",children:["Precio de Venta ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx(C,{id:"price",type:"number",step:"0.01",min:"0",value:t.price,onChange:e=>h("price",e.target.value),placeholder:"0.00",required:!0})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(w,{htmlFor:"cost",children:"Costo"}),d.jsx(C,{id:"cost",type:"number",step:"0.01",min:"0",value:t.cost,onChange:e=>h("cost",e.target.value),placeholder:"0.00"})]})]})})]}),d.jsxs(N,{children:[d.jsx(f,{children:d.jsx(k,{className:"text-lg",children:"Inventario"})}),d.jsx(b,{className:"space-y-4",children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsxs(w,{htmlFor:"stock_quantity",children:["Stock Actual ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx(C,{id:"stock_quantity",type:"number",min:"0",value:t.stock_quantity,onChange:e=>h("stock_quantity",e.target.value),placeholder:"0",required:!0})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(w,{htmlFor:"min_stock",children:"Stock Mínimo"}),d.jsx(C,{id:"min_stock",type:"number",min:"0",value:t.min_stock,onChange:e=>h("min_stock",e.target.value),placeholder:"10"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(w,{htmlFor:"unit",children:"Unidad"}),d.jsxs(I,{value:t.unit,onValueChange:e=>h("unit",e),children:[d.jsx(O,{children:d.jsx(A,{})}),d.jsx($,{children:["unidad","kg","g","litro","ml","paquete","caja","botella","lata","pieza"].map(e=>d.jsx(T,{value:e,children:e},e))})]})]})]})})]}),d.jsxs(N,{children:[d.jsx(f,{children:d.jsx(k,{className:"text-lg",children:"Códigos y Fechas"})}),d.jsxs(b,{className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(w,{htmlFor:"sku",children:"SKU"}),d.jsx(C,{id:"sku",value:t.sku,onChange:e=>h("sku",e.target.value),placeholder:"Código SKU"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(w,{htmlFor:"barcode",children:"Código de Barras"}),d.jsx(C,{id:"barcode",value:t.barcode,onChange:e=>h("barcode",e.target.value),placeholder:"Código de barras"})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(w,{htmlFor:"expiry_date",children:"Fecha de Vencimiento"}),d.jsx(C,{id:"expiry_date",type:"date",value:t.expiry_date,onChange:e=>h("expiry_date",e.target.value)})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(U,{id:"is_active",checked:t.is_active,onCheckedChange:e=>h("is_active",e)}),d.jsx(w,{htmlFor:"is_active",children:"Producto activo"})]})]})]}),d.jsx(V,{}),d.jsxs("div",{className:"flex justify-end gap-2",children:[d.jsx(_,{type:"button",variant:"outline",onClick:r,children:"Cancelar"}),d.jsxs(_,{type:"submit",disabled:i,children:[i?"Guardando...":e?"Actualizar":"Crear"," Producto"]})]})]})},L=({onUpdate:e,onClose:s})=>{const[a,r]=v.useState([]),[t,c]=v.useState(!0),[i,p]=v.useState(!1),[j,g]=v.useState(null),[z,I]=v.useState({name:"",description:"",color:"#22c55e",icon:"package"}),{toast:O}=y();v.useEffect(()=>{A()},[]);const A=()=>n(null,null,function*(){try{c(!0);const e=localStorage.getItem("token"),s=yield fetch("/api/products/categories?include_products=true",{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Error al cargar categorías");{const e=yield s.json();r(e.categories)}}catch(e){O({title:"Error",description:"No se pudieron cargar las categorías",variant:"destructive"})}finally{c(!1)}});return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold",children:"Categorías de Productos"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:"Gestiona las categorías para organizar tu inventario"})]}),d.jsxs(_,{onClick:()=>{g(null),I({name:"",description:"",color:"#22c55e",icon:"package"}),p(!0)},children:[d.jsx(u,{className:"w-4 h-4 mr-2"}),"Nueva Categoría"]})]}),d.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:t?Array.from({length:4}).map((e,s)=>d.jsx(N,{className:"animate-pulse",children:d.jsx(b,{className:"p-6",children:d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),d.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),d.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4"})]})})},s)):0===a.length?d.jsxs("div",{className:"col-span-full text-center py-12",children:[d.jsx(m,{className:"mx-auto h-12 w-12 text-gray-400"}),d.jsx("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"No hay categorías"}),d.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Comienza creando una nueva categoría."})]}):a.map(s=>{return d.jsxs(N,{className:"hover:shadow-md transition-shadow",children:[d.jsx(f,{className:"pb-3",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:s.color},children:d.jsx(m,{className:"w-5 h-5 text-white"})}),d.jsxs("div",{children:[d.jsx(k,{className:"text-lg",children:s.name}),s.description&&d.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]})]}),d.jsxs("div",{className:"flex gap-1",children:[d.jsx(_,{variant:"ghost",size:"sm",onClick:()=>(e=>{g(e),I({name:e.name,description:e.description||"",color:e.color,icon:e.icon}),p(!0)})(s),children:d.jsx(h,{className:"w-4 h-4"})}),d.jsx(_,{variant:"ghost",size:"sm",onClick:()=>(s=>n(null,null,function*(){if(s.product_count&&s.product_count>0)O({title:"No se puede eliminar",description:"Esta categoría tiene productos asociados",variant:"destructive"});else if(confirm(`¿Estás seguro de eliminar la categoría "${s.name}"?`))try{const a=localStorage.getItem("token"),r=yield fetch(`/api/products/categories/${s.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}});if(!r.ok){const e=yield r.json();throw new Error(e.error||"Error al eliminar categoría")}O({title:"Categoría eliminada",description:"La categoría ha sido eliminada exitosamente"}),A(),e()}catch(a){O({title:"Error",description:a instanceof Error?a.message:"Error al eliminar categoría",variant:"destructive"})}}))(s),className:"text-red-600 hover:text-red-700",children:d.jsx(x,{className:"w-4 h-4"})})]})]})}),d.jsxs(b,{className:"space-y-3",children:[d.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-muted-foreground",children:"Productos:"}),d.jsx("div",{className:"font-semibold",children:s.product_count||0})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-muted-foreground",children:"Stock:"}),d.jsx("div",{className:"font-semibold",children:s.total_stock||0})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-muted-foreground",children:"Valor:"}),d.jsx("div",{className:"font-semibold text-xs",children:s.total_value?(a=s.total_value,new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(a)):"$0.00"})]})]}),d.jsx(S,{variant:s.is_active?"default":"secondary",className:"text-xs",children:s.is_active?"Activa":"Inactiva"})]})]},s.id);var a})}),d.jsx(E,{open:i,onOpenChange:p,children:d.jsxs(P,{className:"max-w-md",children:[d.jsx(q,{children:d.jsx(F,{children:j?"Editar Categoría":"Nueva Categoría"})}),d.jsxs("form",{onSubmit:s=>n(null,null,function*(){if(s.preventDefault(),z.name)try{const s=localStorage.getItem("token"),a=j?`/api/products/categories/${j.id}`:"/api/products/categories",r=j?"PUT":"POST",t=yield fetch(a,{method:r,headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(z)});if(!t.ok){const e=yield t.json();throw new Error(e.error||"Error al guardar categoría")}O({title:"Éxito",description:j?"Categoría actualizada exitosamente":"Categoría creada exitosamente"}),p(!1),g(null),I({name:"",description:"",color:"#22c55e",icon:"package"}),A(),e()}catch(a){O({title:"Error",description:a instanceof Error?a.message:"Error al guardar categoría",variant:"destructive"})}else O({title:"Error",description:"El nombre de la categoría es requerido",variant:"destructive"})}),className:"space-y-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsxs(w,{htmlFor:"name",children:["Nombre ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx(C,{id:"name",value:z.name,onChange:e=>I(s=>o(l({},s),{name:e.target.value})),placeholder:"Nombre de la categoría",required:!0})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(w,{htmlFor:"description",children:"Descripción"}),d.jsx(M,{id:"description",value:z.description,onChange:e=>I(s=>o(l({},s),{description:e.target.value})),placeholder:"Descripción de la categoría",rows:3})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(w,{children:"Color"}),d.jsx("div",{className:"flex gap-2 flex-wrap",children:["#22c55e","#3b82f6","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#f97316","#84cc16","#ec4899","#6b7280"].map(e=>d.jsx("button",{type:"button",className:"w-8 h-8 rounded-md border-2 "+(z.color===e?"border-gray-900":"border-gray-200"),style:{backgroundColor:e},onClick:()=>I(s=>o(l({},s),{color:e}))},e))}),d.jsx(C,{type:"color",value:z.color,onChange:e=>I(s=>o(l({},s),{color:e.target.value})),className:"w-full h-10"})]}),d.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[d.jsx(_,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancelar"}),d.jsxs(_,{type:"submit",children:[j?"Actualizar":"Crear"," Categoría"]})]})]})]})})]})},X=()=>{const[e,s]=v.useState([]),[a,r]=v.useState([]),[t,c]=v.useState(!0),[i,l]=v.useState(""),[o,w]=v.useState("all"),[M,U]=v.useState("all"),[V,X]=v.useState("name"),[K,J]=v.useState(1),[H,R]=v.useState(!1),[W,Q]=v.useState(null),[Y,Z]=v.useState(!1),{toast:ee}=y();v.useEffect(()=>{se(),ae()},[K,i,o,M,V]);const se=()=>n(null,null,function*(){try{c(!0);const e=new URLSearchParams({page:K.toString(),limit:20..toString(),sort_by:V,sort_order:"asc"});switch(i&&e.append("search",i),"all"!==o&&e.append("category_id",o),M){case"low":e.append("low_stock","true");break;case"out":e.append("in_stock","false");break;case"in":e.append("in_stock","true")}const a=localStorage.getItem("token"),r=yield fetch(`/api/products?${e}`,{headers:{Authorization:`Bearer ${a}`}});if(!r.ok)throw new Error("Error al cargar productos");{const e=yield r.json();s(e.products)}}catch(e){ee({title:"Error",description:"No se pudieron cargar los productos",variant:"destructive"})}finally{c(!1)}}),ae=()=>n(null,null,function*(){try{const e=localStorage.getItem("token"),s=yield fetch("/api/products/categories?include_products=true",{headers:{Authorization:`Bearer ${e}`}});if(s.ok){const e=yield s.json();r(e.categories)}}catch(e){}}),re=e.filter(e=>e.stock_quantity<e.min_stock&&e.stock_quantity>0).length,te=e.filter(e=>0===e.stock_quantity).length;return d.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold",children:"Inventario"}),d.jsx("p",{className:"text-muted-foreground",children:"Gestiona productos, stock y categorías"})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsxs(_,{variant:"outline",onClick:()=>Z(!0),children:[d.jsx(m,{className:"w-4 h-4 mr-2"}),"Categorías"]}),d.jsxs(E,{open:H,onOpenChange:R,children:[d.jsx(z,{asChild:!0,children:d.jsxs(_,{onClick:()=>Q(null),children:[d.jsx(u,{className:"w-4 h-4 mr-2"}),"Nuevo Producto"]})}),d.jsxs(P,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsx(q,{children:d.jsx(F,{children:W?"Editar Producto":"Nuevo Producto"})}),d.jsx(G,{product:W,categories:a,onSave:()=>{R(!1),Q(null),se()},onCancel:()=>{R(!1),Q(null)}})]})]})]})]}),(re>0||te>0)&&d.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[re>0&&d.jsxs(B,{className:"border-yellow-200 bg-yellow-50",children:[d.jsx(p,{className:"h-4 w-4 text-yellow-600"}),d.jsxs(D,{className:"text-yellow-800",children:[d.jsx("strong",{children:re})," productos con stock bajo"]})]}),te>0&&d.jsxs(B,{variant:"destructive",children:[d.jsx(p,{className:"h-4 w-4"}),d.jsxs(D,{children:[d.jsx("strong",{children:te})," productos sin stock"]})]})]}),d.jsx(N,{children:d.jsx(b,{className:"pt-6",children:d.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[d.jsxs("div",{className:"relative",children:[d.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),d.jsx(C,{placeholder:"Buscar productos...",value:i,onChange:e=>l(e.target.value),className:"pl-10"})]}),d.jsxs(I,{value:o,onValueChange:w,children:[d.jsx(O,{children:d.jsx(A,{placeholder:"Todas las categorías"})}),d.jsxs($,{children:[d.jsx(T,{value:"all",children:"Todas las categorías"}),a.map(e=>d.jsx(T,{value:e.id,children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),e.name,e.product_count&&d.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",e.product_count,")"]})]})},e.id))]})]}),d.jsxs(I,{value:M,onValueChange:U,children:[d.jsx(O,{children:d.jsx(A,{placeholder:"Estado de stock"})}),d.jsxs($,{children:[d.jsx(T,{value:"all",children:"Todos"}),d.jsx(T,{value:"in",children:"En stock"}),d.jsx(T,{value:"low",children:"Stock bajo"}),d.jsx(T,{value:"out",children:"Sin stock"})]})]}),d.jsxs(I,{value:V,onValueChange:X,children:[d.jsx(O,{children:d.jsx(A,{placeholder:"Ordenar por"})}),d.jsxs($,{children:[d.jsx(T,{value:"name",children:"Nombre"}),d.jsx(T,{value:"price",children:"Precio"}),d.jsx(T,{value:"stock_quantity",children:"Stock"}),d.jsx(T,{value:"created_at",children:"Fecha"})]})]})]})})}),d.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:t?Array.from({length:6}).map((e,s)=>d.jsx(N,{className:"animate-pulse",children:d.jsx(b,{className:"p-6",children:d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),d.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),d.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4"})]})})},s)):0===e.length?d.jsxs("div",{className:"col-span-full text-center py-12",children:[d.jsx(m,{className:"mx-auto h-12 w-12 text-gray-400"}),d.jsx("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"No hay productos"}),d.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Comienza agregando un nuevo producto."}),d.jsx("div",{className:"mt-6",children:d.jsxs(_,{onClick:()=>R(!0),children:[d.jsx(u,{className:"w-4 h-4 mr-2"}),"Nuevo Producto"]})})]}):e.map(e=>{const s=(e=>0===e.stock_quantity?{status:"out",label:"Sin stock",color:"destructive"}:e.stock_quantity<e.min_stock?{status:"low",label:"Stock bajo",color:"warning"}:{status:"ok",label:"En stock",color:"success"})(e);return d.jsxs(N,{className:"hover:shadow-md transition-shadow",children:[d.jsx(f,{className:"pb-3",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"space-y-1 min-w-0 flex-1",children:[d.jsx(k,{className:"text-lg truncate",children:e.name}),e.description&&d.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.description})]}),d.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0 ml-2",style:{backgroundColor:e.categories.color},title:e.categories.name})]})}),d.jsxs(b,{className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-muted-foreground",children:"Precio:"}),d.jsx("div",{className:"font-semibold text-lg",children:(a=e.price,new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(a))})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-muted-foreground",children:"Stock:"}),d.jsxs("div",{className:"font-semibold",children:[e.stock_quantity," ",e.unit]})]})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx(S,{variant:s.color,className:"text-xs",children:s.label}),e.sku&&d.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[d.jsx(g,{className:"w-3 h-3 mr-1"}),e.sku]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsxs(_,{variant:"outline",size:"sm",onClick:()=>{Q(e),R(!0)},className:"flex-1",children:[d.jsx(h,{className:"w-4 h-4 mr-1"}),"Editar"]}),d.jsx(_,{variant:"outline",size:"sm",onClick:()=>(e=>n(null,null,function*(){if(confirm(`¿Estás seguro de eliminar "${e.name}"?`))try{const s=localStorage.getItem("token");if(!(yield fetch(`/api/products/${e.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok)throw new Error("Error al eliminar producto");ee({title:"Producto eliminado",description:"El producto ha sido eliminado exitosamente"}),se()}catch(s){ee({title:"Error",description:"No se pudo eliminar el producto",variant:"destructive"})}}))(e),className:"text-red-600 hover:text-red-700",children:d.jsx(x,{className:"w-4 h-4"})})]})]})]},e.id);var a})}),!t&&e.length>0&&d.jsxs("div",{className:"flex justify-center gap-2",children:[d.jsx(_,{variant:"outline",onClick:()=>J(e=>Math.max(1,e-1)),disabled:1===K,children:"Anterior"}),d.jsx(_,{variant:"outline",onClick:()=>J(e=>e+1),disabled:e.length<20,children:"Siguiente"})]}),d.jsx(E,{open:Y,onOpenChange:Z,children:d.jsxs(P,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[d.jsx(q,{children:d.jsx(F,{children:"Gestión de Categorías"})}),d.jsx(L,{onUpdate:ae,onClose:()=>Z(!1)})]})})]})};export{X as default};
