import{j as e,ab as s,as as a,at as t,ap as r,a7 as i}from"./chunk-D1ivKm1I.js";import{a as l}from"./chunk-CNNdbZTC.js";import{u as n,k as c,C as o,d,e as m,b as x,B as h}from"./index-17eEFbcJ.js";import{u as g}from"./chunk-DqMloB5Z.js";const u=({product:u,className:j})=>{const{addToFavorites:p,removeFromFavorites:b,isFavorite:v}=n(),{isInCart:N,getItemQuantity:f}=c(),{addToCartWithNotification:w}=g(),[y,k]=l.useState(!1),P=u.originalPrice?Math.round((u.originalPrice-u.price)/u.originalPrice*100):0;return e.jsx(o,{className:d("group relative overflow-hidden border-0 shadow-sm hover:shadow-md transition-all duration-200 sm:hover:-translate-y-1","mobile-card sm:p-4",!u.inStock&&"opacity-75",j),children:e.jsxs(m,{className:"p-0",children:[e.jsxs("div",{className:"relative aspect-square overflow-hidden bg-gray-50",children:[e.jsx("img",{src:u.image,alt:u.name,className:"h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"}),e.jsxs("div",{className:"absolute top-2 left-2 flex flex-col gap-1",children:[u.isNew&&e.jsx(x,{className:"bg-purple-500 hover:bg-purple-600 text-white text-xs",children:"Nuevo"}),u.isOffer&&P>0&&e.jsxs(x,{className:"bg-red-500 hover:bg-red-600 text-white text-xs",children:["-",P,"%"]}),!u.inStock&&e.jsx(x,{variant:"secondary",className:"text-xs",children:"Agotado"})]}),e.jsx(h,{variant:"ghost",size:"sm",className:d("absolute top-2 right-2 h-8 w-8 rounded-full backdrop-blur-sm transition-all duration-200",v(u.id)?"bg-red-100/90 hover:bg-red-200/90 shadow-md":"bg-white/80 hover:bg-white/90"),onClick:()=>{v(u.id)?b(u.id):p(u.id)},children:e.jsx(s,{className:d("h-4 w-4 transition-colors",v(u.id)?"fill-red-500 text-red-500":"text-gray-600")})}),u.inStock&&u.stock<=5&&e.jsx("div",{className:"absolute bottom-2 left-2",children:e.jsxs(x,{variant:"outline",className:"bg-white/90 text-xs",children:["Ãšltimas ",u.stock," unidades"]})})]}),e.jsxs("div",{className:"p-3 sm:p-4",children:[u.brand&&e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:u.brand}),e.jsx("h3",{className:"font-medium text-sm sm:text-base text-gray-900 line-clamp-2 mb-2 leading-tight",children:u.name}),e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(a,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-xs text-gray-600 ml-1",children:u.rating})]}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",u.reviewCount,")"]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(t,{className:"h-3 w-3 text-fresh-500"}),e.jsx("span",{className:"text-xs text-gray-600",children:u.deliveryTime})]}),u.aisle&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(r,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-500",children:u.aisle})]})]}),e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-bold text-lg text-gray-900",children:["$",u.price]}),u.unit&&e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:["/",u.unit]}),u.originalPrice&&e.jsxs("span",{className:"text-sm text-gray-500 line-through",children:["$",u.originalPrice]})]})}),e.jsx(h,{onClick:()=>{return e=null,s=null,a=function*(){if(u.inStock){k(!0);try{yield new Promise(e=>setTimeout(e,300)),w(u.id,1,u.name)}catch(e){}finally{k(!1)}}},new Promise((t,r)=>{var i=e=>{try{n(a.next(e))}catch(s){r(s)}},l=e=>{try{n(a.throw(e))}catch(s){r(s)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,l);n((a=a.apply(e,s)).next())});var e,s,a},disabled:!u.inStock||y,className:d("w-full h-10 sm:h-9 text-sm font-medium transition-all duration-200 mobile-btn sm:btn-auto",u.inStock?"btn-gradient hover:shadow-glow focus:shadow-glow":"bg-gray-200 text-gray-500 cursor-not-allowed"),children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Agregando..."]}):u.inStock?N(u.id)?e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"h-4 w-4 mr-2"}),"En carrito (",f(u.id),")"]}):e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"h-4 w-4 mr-2"}),"Agregar al carrito"]}):e.jsx(e.Fragment,{children:"Agotado"})})]})]})})};export{u as P};
